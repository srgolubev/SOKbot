# Этап 3: Интеграция с Google Sheets API

**Версия:** 1.0  
**Дата:** 25.02.2025  
**Автор:** [Ваше Имя или Команда разработки]

---

## 1. Настройка доступа

### 1.1 Создание проекта в Google Cloud Console
- Перейдите на [Google Cloud Console](https://console.cloud.google.com/).
- Создайте новый проект или выберите существующий.
- Убедитесь, что в выбранном проекте активированы необходимые API, в частности Google Sheets API.

### 1.2 Настройка OAuth 2.0 и получение учетных данных
- В консоли Google Cloud перейдите в раздел "APIs & Services" → "Credentials".
- Нажмите **Create Credentials** и выберите **OAuth client ID**.
- Настройте экран согласия OAuth, указав необходимые данные (название, логотип, контактную информацию).
- Выберите тип приложения (например, Desktop или Web application) и получите клиентский ID и секрет.
- Сохраните полученные учетные данные в безопасном месте, они потребуются для авторизации запросов к Google Sheets API.

---

## 2. Реализация функций

### 2.1 Функция для создания нового листа по шаблону
- **Описание:** Функция должна:
  - Принимать название нового проекта и, возможно, идентификатор шаблона.
  - Создавать новый лист в основной Google Таблице.
  - Применять форматирование и предварительно заданный шаблон (например, добавление определённых заголовков).
- **Пример логики реализации:**
  - Использовать метод `spreadsheets.batchUpdate` для создания нового листа.
  - Настроить шаблон, добавив стандартные стили, размеры столбцов и форматирование ячеек.

### 2.2 Функция для записи списка разделов
- **Описание:** Функция должна:
  - Принимать список разделов (например, `["аренда", "судьи", "звук", "свет", "сцена", "сувенирка", "наградная"]`).
  - Записывать эти данные в виде заголовков столбцов или строк на новом листе.
- **Пример логики реализации:**
  - Использовать метод `spreadsheets.values.update` или `spreadsheets.values.append` для внесения данных.
  - Обеспечить, чтобы данные корректно отображались в заданных ячейках (например, первая строка листа может быть отведена под заголовки).

---

## 3. Тестирование API

### 3.1 Тестирование создания листов
- Создайте тестовую Google Таблицу.
- Выполните функцию создания нового листа, передав тестовые данные.
- Проверьте, что новый лист создан и соответствует заданному шаблону (проверьте наличие нужных столбцов, форматирование и стили).

### 3.2 Тестирование обновления листов
- Выполните функцию записи списка разделов.
- Проверьте, что заголовки (или данные) корректно внесены в созданный лист.
- Оцените, как обрабатываются ошибки (например, если указан неверный идентификатор листа).

### 3.3 Инструменты и подходы для тестирования
- Используйте Postman или аналогичные инструменты для тестирования REST-запросов.
- Реализуйте простые скрипты на Python для вызова функций создания и обновления листа, выводя результаты в консоль.
- Логируйте все запросы и ответы API для упрощения отладки.

---

## 4. Заключение

Данный этап обеспечивает интеграцию с Google Sheets API, позволяя автоматически создавать и обновлять листы в таблицах. Реализованные функции будут использоваться на следующих этапах проекта для создания нового листа по шаблону и внесения в него данных, полученных от NLP-парсера.

При успешном тестировании данного этапа можно переходить к полной интеграции с ботом для автоматической обработки входящих команд и управления данными в Google Таблицах.

---
